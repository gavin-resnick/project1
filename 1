def complete_test(t):
    
    i = make_array()
   
    for n in np.arange(100):
        sample = t.sample(t.num_rows, with_replacement=True)
        new_table = t.with_columns('Condition', sample.column('Condition'), 
                                      'Died sum', make_array(sample.where('Died', True).where('Condition', 'Control').num_rows,
                                                             sample.where('Died', True).where('Condition', 'Diet').num_rows),
                                      'Participated sum', make_array(sample.where('Condition', 'Control').where('Participated', True).num_rows,
                                                                     sample.where('Condition', 'Diet').where('Participated', True).num_rows))
        
        w_hazard = new_table.with_column('Hazard Rate', make_array(new_table.column('Died sum').item(0)/
                                                                  new_table.column('Participated sum').item(0),
                                                                  (new_table.column('Died sum').item(1)/
                                                                  new_table.column('Participated sum').item(1))))
                                                                
        j = compute_hazard_difference(w_hazard)
        
        i = np.append(i, j)
    return i

our_p_value = complete_test(minnesota_data)
our_p_value
